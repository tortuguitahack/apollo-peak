<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="A product of emergent.sh" />
    <!-- Opcional: añade una meta para inyectar la clave desde el servidor -->
    <!-- <meta name="posthog-api-key" content="your_key_here" /> -->
    <title>Emergent | Fullstack App</title>

    <link rel="icon" href="/favicon.ico" />
    <link rel="manifest" href="/manifest.json" />

    <script src="https://assets.emergent.sh/scripts/emergent-main.js" defer></script>

    <style>
        #emergent-badge {
            display: flex !important;
            align-items: center !important;
            position: fixed !important;
            bottom: 20px;
            right: 20px;
            text-decoration: none;
            padding: 6px 10px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif !important;
            font-size: 12px !important;
            z-index: 9999 !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
            border-radius: 8px !important;
            background-color: #ffffff !important;
            border: 1px solid rgba(0, 0, 0, 0.08) !important;
            color: #000;
        }
        #emergent-badge img {
            width: 20px;
            height: 20px;
            margin-right: 8px;
            display: inline-block;
        }
        #emergent-badge p {
            margin: 0;
            line-height: 1;
            font-size: 12px !important;
        }
    </style>

    <script>
        if (window.self !== window.top) {
            (function() {
                var s = document.createElement('script');
                s.src = 'https://assets.emergent.sh/scripts/debug-monitor.js';
                s.async = true;
                s.crossOrigin = 'anonymous';
                document.head.appendChild(s);
            })();

            (function() {
                window.tailwind = window.tailwind || {};
                tailwind.config = { corePlugins: { preflight: false } };
                var t = document.createElement('script');
                t.src = 'https://cdn.tailwindcss.com';
                t.async = true;
                document.head.appendChild(t);
            })();
        }
    </script>

    <script defer src="/static/js/bundle.js"></script>
</head>
<body>
    <noscript>
        This application requires JavaScript to run. Please enable JavaScript in your browser.
    </noscript>

    <div id="root" role="main" aria-live="polite"></div>

    <a id="emergent-badge"
       href="https://app.emergent.sh/?utm_source=emergent-badge"
       target="_blank"
       rel="noopener noreferrer"
       aria-label="Made with Emergent - opens in a new tab">
        <img src="https://avatars.githubusercontent.com/in/1201222?s=120&u=2686cf91179bbafbc7a71bfbc43004cf9ae1acea&v=4" alt="Emergent logo" />
        <p>Made with Emergent</p>
    </a>

    <script>
        // Inicialización asíncrona y anonimizada de PostHog.
        // Reemplazamos la clave pública por un placeholder y preferimos inyectarla desde:
        //  - una meta tag <meta name="posthog-api-key" content="...">
        //  - o desde una variable de entorno en el servidor (renderizado).
        (function (window, document) {
            window.posthog = window.posthog || [];
            if (window.posthog.__SV) return;
            window.posthog.__SV = 1;

            var initStub = function (method) {
                return function () {
                    var args = Array.prototype.slice.call(arguments);
                    window.posthog.push([method].concat(args));
                };
            };

            var methods = "capture identify alias people.set people.getFeatureFlag on".split(" ");
            for (var i = 0; i < methods.length; i++) {
                window.posthog[methods[i]] = initStub(methods[i]);
            }

            var script = document.createElement("script");
            script.type = "text/javascript";
            script.async = true;
            script.crossOrigin = "anonymous";
            script.src = "https://us-assets.i.posthog.com/static/array.js";
            var first = document.getElementsByTagName("script")[0];
            first.parentNode.insertBefore(script, first);
        })(window, document);

        // Obtener la clave PostHog desde meta tag o placeholder.
        (function () {
            var meta = document.querySelector('meta[name="posthog-api-key"]');
            var keyFromMeta = meta ? meta.content.trim() : '';
            // Placeholder visible en el archivo: replace_me_with_posthog_key
            var placeholder = "replace_me_with_posthog_key";

            var phKey = keyFromMeta || placeholder;

            try {
                if (phKey && phKey !== placeholder) {
                    posthog.init(phKey, {
                        api_host: "https://us.i.posthog.com",
                        person_profiles: "identified_only"
                    });
                } else {
                    // No inicializar si no hay clave real.
                    console.info("PostHog not initialized: API key not provided (use meta[name=\"posthog-api-key\"])");
                }
            } catch (e) {
                console.warn("posthog init failed", e);
            }
        })();
    </script>

    <!-- Notas:
         - Añade /manifest.json y /favicon.ico en public si no existen.
         - Para producción, inyecta la clave real desde el servidor via meta tag o configuración.
         - Considera mover analytics al servidor o usar variables de entorno en build.
    -->
</body>
</html>