<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="A product of emergent.sh" />
    <title>Emergent | Fullstack App</title>

    <!-- Favicon y manifest (añade manifest.json y favicon.ico en /public si no existen) -->
    <link rel="icon" href="/favicon.ico" />
    <link rel="manifest" href="/manifest.json" />

    <!-- Script principal de Emergent -->
    <script src="https://assets.emergent.sh/scripts/emergent-main.js" defer></script>

    <!-- Estilos para el badge (separados del HTML para mejor mantenimiento) -->
    <style>
        /* Estilos específicos para el badge emergent */
        #emergent-badge {
            display: flex !important;
            align-items: center !important;
            position: fixed !important;
            bottom: 20px;
            right: 20px;
            text-decoration: none;
            padding: 6px 10px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif !important;
            font-size: 12px !important;
            z-index: 9999 !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
            border-radius: 8px !important;
            background-color: #ffffff !important;
            border: 1px solid rgba(0, 0, 0, 0.08) !important;
            color: #000;
        }
        #emergent-badge img {
            width: 20px;
            height: 20px;
            margin-right: 8px;
            display: inline-block;
        }
        #emergent-badge p {
            margin: 0;
            line-height: 1;
            font-size: 12px !important;
        }
    </style>

    <!-- Cargar scripts de edición visual / Tailwind únicamente cuando estemos en iframe (no bloquear UI) -->
    <script>
        if (window.self !== window.top) {
            // Debug monitor (no crítico)
            (function() {
                var s = document.createElement('script');
                s.src = 'https://assets.emergent.sh/scripts/debug-monitor.js';
                s.async = true;
                s.crossOrigin = 'anonymous';
                document.head.appendChild(s);
            })();

            // Cargar Tailwind desde CDN (solo en contextos de edición visual)
            (function() {
                window.tailwind = window.tailwind || {};
                tailwind.config = { corePlugins: { preflight: false } };
                var t = document.createElement('script');
                t.src = 'https://cdn.tailwindcss.com';
                t.async = true;
                document.head.appendChild(t);
            })();
        }
    </script>

    <!-- Bundle de la app (si existe). Mantener defer para no bloquear el parseo -->
    <script defer src="/static/js/bundle.js"></script>
</head>
<body>
    <noscript>
        This application requires JavaScript to run. Please enable JavaScript in your browser.
    </noscript>

    <div id="root" role="main" aria-live="polite"></div>

    <!-- Emergent badge: seguro y accesible -->
    <a id="emergent-badge"
       href="https://app.emergent.sh/?utm_source=emergent-badge"
       target="_blank"
       rel="noopener noreferrer"
       aria-label="Made with Emergent - opens in a new tab">
        <img src="https://avatars.githubusercontent.com/in/1201222?s=120&u=2686cf91179bbafbc7a71bfbc43004cf9ae1acea&v=4" alt="Emergent logo" />
        <p>Made with Emergent</p>
    </a>

    <!-- PostHog analytics (mantener la clave pública si la necesitas; opcional si no quieres tracking) -->
    <script>
        // Snippet asíncrono para inicializar posthog sin bloquear
        (function (window, document, posthogVar) {
            window.posthog = window.posthog || [];
            if (window.posthog.__SV) return;
            window.posthog.__SV = 1;

            var initStub = function (method) {
                return function () {
                    var args = Array.prototype.slice.call(arguments);
                    window.posthog.push([method].concat(args));
                };
            };

            var methods = "capture identify alias people.set people.getFeatureFlag on".split(" ");
            for (var i = 0; i < methods.length; i++) {
                window.posthog[methods[i]] = initStub(methods[i]);
            }

            var script = document.createElement("script");
            script.type = "text/javascript";
            script.async = true;
            script.crossOrigin = "anonymous";
            // Use the hosted assets for posthog; this URL is what your previous snippet used
            script.src = "https://us-assets.i.posthog.com/static/array.js";
            var first = document.getElementsByTagName("script")[0];
            first.parentNode.insertBefore(script, first);

        })(window, document, "posthog");

        // Inicialización (clave pública visible en el repo; si no quieres exponerla, mueve esto a servidor)
        try {
            posthog.init("phc_yJW1VjHGGwmCbbrtczfqqNxgBDbhlhOWcdzcIJEOTFE", {
                api_host: "https://us.i.posthog.com",
                person_profiles: "identified_only" // 'always' también es una opción
            });
        } catch (e) {
            // No romper la app si analytics falla
            console.warn("posthog init failed", e);
        }
    </script>

    <!-- Sugerencias adicionales:
         1) Añade /manifest.json y /favicon.ico a tu carpeta public si todavía no existen.
         2) Considera mover claves sensibles/configs fuera del HTML.
         3) Agrega SRI (integrity) y crossorigin a scripts críticos si tienes las sumas.
         4) Revisa /static/js/bundle.js: si es parte del build, mantenlo; si no existe, quita la referencia.
    -->
</body>
</html>
